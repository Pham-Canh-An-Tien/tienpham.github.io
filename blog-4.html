<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Blog</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: DevFolio - v4.8.1
  * Template URL: https://bootstrapmade.com/devfolio-bootstrap-portfolio-html-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">

      <h1 class="logo"><a href="index.html">Tien Pham</a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="#hero">Home</a></li>
          <li><a class="nav-link scrollto" href="#about">About</a></li>
          <li><a class="nav-link scrollto" href="#services">Education</a></li>
          <li><a class="nav-link scrollto " href="#work">Project</a></li>
          <li><a class="nav-link scrollto " href="#blog">Publications</a></li>
          <li><a class="nav-link scrollto" href="#contact">Contact</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->

  <div class="hero hero-single route bg-image" style="background-image: url(assets/img/background.jpg)">
    <div class="overlay-mf"></div>
    <div class="hero-content display-table">
      <div class="table-cell">
        <div class="container">
          <h2 class="hero-title mb-4">Wild Animal Image Classification</h2>
        </div>
      </div>
    </div>
  </div>

  <main id="main">

    <!-- ======= Blog Single Section ======= -->
    <section class="blog-wrapper sect-pt4" id="blog">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="post-box">
              <div class="post-thumb">
                <!-- <img src="assets/img/kaggle1/titanic.jpg" class="img-fluid" alt=""> -->
              </div>
              <div class="post-meta">
                <h1 class="article-title">Wild Animal Classification With Convolutional Neural Network, Support Vector Machine and Random Forest
                </h1>
                <ul>
                  <li>
                    <span class="bi bi-person"></span>
                    <a href="/index.html">Tien Pham</a>
                  </li>
                  <li>
                    <span class="bi bi-tag"></span>
                    <a href="https://www.kaggle.com/code/tienapham/draft-10-05/data?scriptVersionId=107442102">Image Classification</a>
                  </li>
                  <li>
                    <span class="bi bi-tag"></span>
                    Convolutional Neural Network</a>
                  </li>
                  <li>
                    <span class="bi bi-tag"></span>
                    Support Vector Machine
                  </li>
                  <li>
                    <span class="bi bi-tag"></span>
                    K-nearest neighbor
                  </li>
                  <li>
                    <span class="bi bi-tag"></span>
                    Random Forest Classifier
                  </li>
                </ul>
              </div>
              <div class="article-content">
                <h1 class="article-title">Introduction</h1>
                <p>
                  In myprevious <a href="blog-2.html"><b>Blog</b></a>, I have introduced the Convolutional Neural Network approach for image classification.
                  In this blog, we will try a more chalenging dataset and compare the performance between multiples model.
                </p>
                <h1 class="article-title">Dataset preparation</h1>
                <p>
                 We use the <a href="https://www.kaggle.com/datasets/whenamancodes/wild-animals-images"><b>Wild Animal Dataset</b></a> from Kaggle where we have images from 6 animals. In
                 the dataset, the author already rescaled the images for us to multiple resolutions. However, we can do it while loading the data. We use the image in 300x300 dpi for our model.
                 I also found out that there are two images in Hynea/00000224_300resized.png and Chetah/00000244_300resized.png which are broken. We need to manually remove it to avoid later errors.
                 <img src="assets/img/kaggle4/1.jpg" width = "1000">
                </p>
                After that, we will upload the dataset to google drive and mount the drive to Google Colab for model building.
                <img src="assets/img/kaggle4/2.jpg" width = "1000">
                <p>
                  We divide the data to training, validating and testing dataset with the ratio of 6:2:2 as common practice.
                </p>
                <h1 class="article-title">Convolutional Neural Network</h1>
                <p>
                  The first approach is using Convulutional Neural Network which has been used widely for image classification. I tried with the model as
                  in previous blog.
                  <img src="assets/img/kaggle4/model1.jpg" width = "1000">
                  <img src="assets/img/kaggle4/model11.jpg" width = "1000">
                </p>
                <p>
                  The performance is really bad with the accuracy of 62.91%. While looking at the loss function, we see that the model is overfitted to the training set.
                  <img src="assets/img/kaggle4/lossfunc.jpg" width = "1000">
                </p>
                <p>
                  Training accuracy is always 100% while the validating accuracy is conversed to 0.6. Furthermore, while looking at loss graph, the validation lossfunc
                  is increasing as the increase of epoch. This is clearly the overfitting problem. To overcome this problem, we now use the <b>Data Augumentation</b> technique
                  to increase the training dataset as well as increase the randomness of the images. We will embed the data augumentation layer to the model so that
                  the training data will be randomly distributed during training phase which can reduce the overfitting.
                  <img src="assets/img/kaggle4/rotate.jpg" width = "1000">
                </p>

                  After using the augumentation technique, we can retrain the model and see that the overfitting phenomenon reduce while the accuracy can go up to
                  70%
                  <img src="assets/img/kaggle4/lossfunc1.jpg" width = "1000">
                
                <h1 class="article-title">Hyperparameter tuning</h1>
                After spending time to tune hyperparameters such as <b>epoch, batch size, adding layers to models</b>, I got the final model
                <img src="assets/img/kaggle4/sumary.jpg" width = "1000">
                <p>
                  As you can see, the more Convolutional layers we add into the model, the more accuracy the model performs on validating dataset. This will
                  infer that our dataset is much more complex than previous example that the model need to me more complicated to predict well. Furthermore,
                  the accuracy also increases while increasing the batchsize, this is explained why the more batchsize, the better learning phase is because the model
                  will also learn the relationship between samples in one batch.
                </p>
                <h1 class="article-title">Dimentionality Reduction using Principal Component Analysis</h1>
                <p>
                  For other techniques such as K-Nearest Neighbor, Support Vector Machine or Random Forest, we have to extract features from the images by ourselves to reduce
                  the computational cost and remove the unimportant features. There are several ways to extract features from a given dataset. In this tutorials, I will use
                  <b>Principal Component Analysis</b> which are widely used in several applications. Principal Component Analysis based on Singular Value Decomposition of the data
                  to project it to a lower dimentional space [].
                </p>
                <img src="assets/img/kaggle4/pca.jpg" width = "600">
                <p>
                  <b>Image Source: Machine Learning Lectures by Prof. Andrew NG at Stanford University</b>
                </p>
                <p>
                  With PCA transformation, we will retrive the most informative features (calculated by the PCA score) which would be meaningful to differentiate the images.
                  However, the number of features will be constrained by the number of samples in our dataset. I will use 512 features in this tutorial.
                </p>
                <h1 class="article-title">K-Nearest Neighbor</h1>
                <p>
                  K-Nearest neighbor is the regressive algorithm based on the distance between the test samples with the k-nearest samples from each class.
                </p>
                <img src="assets/img/kaggle4/knn.png" width = "600">
                <p>
                  Source: https://www.javatpoint.com/k-nearest-neighbor-algorithm-for-machine-learning
                </p>
                <p>
                  To evaluate the performance of K-nearest neighbor algorithm, I run the KNN model with k-value ranging from 2 to 20
                  <img src="assets/img/kaggle4/knn.jpg" width = "600">
                </p>
                The performance is really bad (only around 30%). I also run without the dimentional reduction to see how it performs.
                <img src="assets/img/kaggle4/knn1.jpg" width = "600">
                <p>
                  As you can see in the figures above, the performance of the two data is not much different, but dimentional reduction reduce compotational
                  cost alot because they remove all the non-informative features.
                </p>
                <h1 class="article-title">Random Forest Classifier</h1>
                <p>
                  We all know about the decision tree in Data Mining. Let's apply the random forest classifier to this problem. Random Forest Classifier
                contains multiples decision trees with the predefined number of trees. The output will be the class selected by the most decision trees.
                </p>
                <img src="assets/img/kaggle4/random.jpeg" width = "600">
                <p>
                  We also evaluate the performance of Random Forest Classifier with various configuration
                </p>
                <img src="assets/img/kaggle4/rfc.jpg" width = "600">
                <p>The performance is slightly higher than 35%. One thing interesting here is that the performance fluctuate while we adding more tree into the forest. </p>
                <h1 class="article-title">Support Vector machine</h1>
                <p>
                  Support Vector Machine are supervised learning model in which the hyperplane is built between the classes. The hyperplane is based on the vector constructed
                  by the most outer samples in a optimization of margin between classes.
                </p>
                <img src="assets/img/kaggle4/svm.png" width = "600">
                <p>
                  For SVM, we will get the classification report including precision, recall, f1-score and support.
                </p>
                <img src="assets/img/kaggle4/svm.jpg" width = "400">
                <h1 class="article-title">Test performance</h1>
                <p>From all above models, we will use the test dataset to evaluate the performance</p>
                <img src="assets/img/kaggle4/eval.jpg" width = "400">
                <p>
                  As we can see in the figure, CNN outperform other models with the accuracy is almost 70%. Other model performance fluctuate between 30 and 40%.
                  I also list out the pros and cons of each models as below:
                </p>
                <img src="assets/img/kaggle4/per.jpg" width = "800">
                <p>
                  Furthermore, KNN is computationally intensive for interference, but it is still not as much as CNN training phase. CNN also has more rooms for performance
                  improvement such as hyperparameter tuning. While other are lack of rooms for improvement.
                </p>
                  <h1 class="article-title">Conclusion</h1>
                  <p>
                    The blog has shown the implementation of various image classifier including dataset preparation and performance evalutation. We can conclude that 
                    Convolutional Neural Network outperforms other model and still has alot of promising ways for improvements. The code for this tutorial can be found <a href="https://github.com/Pham-Canh-An-Tien/data-mining/blob/main/wild_animal_images.ipynb"><b>here</b></a>.
                  </p>
                  <h1 class="article-title">Challenges and Solution</h1>
                  <p>
                    I have been facing many challenges in this homework. Some of them have been solved but I could not make it for all of problems. The challenges and proposed
                    solution are below:
                    <li>
                      The test dataset is <b>broken</b>. I have to debug and manually check and clean it. I also organize the directory for further process
                    </li>
                    <li>
                      The dataset is much more chalenging while some of images has multiple animals (a crowd of animals). For this problem, I don't know how to overcome
                    </li>
                    <li>
                      For dimentionality reduction, I have to investigate on the theory and understand it (mathematically intensive)
                    </li>
                    <li>
                      Some image are full body of animal, while other just have their face. I think it will increase the complexity of the dataset
                    </li>
                  </p>
                  <h1 class="article-title">Contribution</h1>
                  <p>
                    The Notebook have been developed by Tien Pham with no reference from tensorflow and sklearn examples (which is very time consuming to understand the theory, build the code
                    , debug and try with different approach). My contributions are listed below:
                    <li>
                      I implemented the code and tried hyperparameter tuning</b>.
                    </li>
                    <li>
                      I tried to understand the theory of Principal Component Analysis and Implement this for feature extraction. I also compare the performance of the model with and without the PCA</b>.
                    </li>
                    <li>
                      I tried to build the CNN model and reduce the overfitting</b>.
                    </li>
                    <li>
                      I do evaluate the performance of various models with various configuration.
                    </li>
                    <li>
                      I wrote the script to evaluate each models.
                    </li>
                  </p>
                  <h1 class="article-title">References</h1>
                  <p>
                    [1]. Müller, Andreas C., and Sarah Guido. Introduction to machine learning with Python: a guide for data scientists. " O'Reilly Media, Inc.", 2016.
                  </p>
                  <p>
                    [2]. Schlegel, Daniel. "Deep machine learning on Gpu." University of Heidelber-Ziti 12 (2015).</a>
                  </p>
                  <p>
                    [3]. <a href="https://www.tensorflow.org/tutorials/images/cnn"> TensorFlow.</a>
                  </p>
                  <p>
                    [4]. Deng, Jia, et al. "Imagenet: A large-scale hierarchical image database." 2009 IEEE conference on computer vision and pattern recognition. Ieee, 2009.</a>
                  </p>
                  <p>
                    [5]. Support Vector Machine — Introduction to Machine Learning Algorithms</a>
                  </p>
                  <p>
                    [6]. What Is K-Nearest Neighbor? An ML Algorithm to Classify Data</a>
                  </p>
                  <p>
                    [7]. <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.ensemble"> Sklearn library.</a>
                  </p>
              </div>
            </div>
          
        
        </div>
      </div>
    </section><!-- End Blog Single Section -->

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <div class="copyright-box">
            <p class="copyright">&copy; Copyright <strong>Tien Pham</strong>. All Rights Reserved</p>
            <div class="credits">
              <!--
              All the links in the footer should remain intact.
              You can delete the links only if you purchased the pro version.
              Licensing information: https://bootstrapmade.com/license/
              Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=DevFolio
            -->
              <!-- Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer><!-- End  Footer -->

  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>